/*
 * JSquares2 for jQuery
 * 
 * http://roubenmeschian.com
 * 
 * Dual licensed under the MIT and GPL licenses.
 *
 * Version: 1.0
 * 
 * Fork of jSquares - http://boedesign.com/blog/2009/10/22/jsquares-for-jquery/
 *
 */
(function(a){a.fn.jsquares2=a.fn.jSquares2=function(b){var c={smallImg:".js-small-image",image:".js-image",caption_width:600,caption_delay:20,fade_to:.3,fade_start:1,fade_on_hover:true,caption_animate:true,caption_animate_time:300,_overlay_selector_class:"js-caption-overlay"};b=a.extend(c,b);var d,e=this,f=[],g;var h=function(a,b){if(b===undefined)b=130;f.push(a);if(g)window.clearTimeout(g);g=window.setTimeout(function(){var a=f.pop();f=new Array;a()},b)};var i=function(a,c){var f=a||d;h(function(){if(!f)return;f.remove();if(d&&d[0]===f[0])d=null;h(function(){if(b.fade_on_hover)e.find(b.smallImg).css("opacity",b.fade_start)},0)})};e.mousemove(function(){i()});e.find(b.image).mousemove(function(){return false});e.find(b.image).mouseenter(function(){var c=this;var f=a(c);h(function(){if(d){if(d.js2T===c)return;d.remove()}var g=f.offset();var j=f.height();var k=f.width();var l=e.offset().left+e.width()/2;var m=g.left<l;var n=document.createElement("div");n.innerHTML=m?"<table><tr><td style='line-height: 0'><img class='js-caption-img' src='"+f.find(".js-small-image").attr("src")+"'/></td><td style='padding-left: 10px'><div class='jsquares2CaptionTxt' style='display: none'>"+f.find(".js-overlay-caption-content").html()+"</div></td></tr></table>":"<table><tr><td style='padding-right: 10px; width: 100%'><div class='jsquares2CaptionTxt' style='display: none'>"+f.find(".js-overlay-caption-content").html()+"</div></td><td style='line-height: 0'><img class='js-caption-img' src='"+f.find(".js-small-image").attr("src")+"'/></td></tr></table>";d=a(n);if(b.caption_img_height)d.find(".js-caption-img").css("height",b.caption_img_height);d.js2T=c;var o=b.caption_width;var p=b.caption_animate?b.caption_width*2/3:o;var q=g.top;var r=g.left;if(!m)r=r+k-(p+23);d.mouseleave(function(){i(d,c)});d.mouseenter(function(){h(function(){})});d.css("top",q).css("left",r).css("width",p).css("min-height",j-22).addClass(b._overlay_selector_class);a("body").append(n);var s=function(){d.find(".jsquares2CaptionTxt").css("display","inherit")};if(b.caption_animate){if(m){d.animate({width:o},b.caption_animate_time,null,s)}else{r-=o-p;d.animate({left:r,width:o},b.caption_animate_time,null,s)}}else{s()}if(b.fade_on_hover)e.find(b.smallImg).css("opacity",b.fade_to)},b.caption_delay)});return this}})(jQuery)